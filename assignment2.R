getRunsMatrix<-function(n, runLength) {
	heads<-rep(1, runLength);
	tails<-rep(0, n-runLength+1);
	data<-c(
		rep(c(heads,tails),n-runLength),
		heads
	);
	return(matrix(data=data,ncol=n,byrow=TRUE));
}

getFlipsMatrix<-function(n) {
	return(rbinom(n,1,0.5));
}

testForRuns<-function(flips, runs, runLength) {
	prod<- runs %*% flips;
	return(runLength %in% prod);
}

getProbability<-function(n=100, runLength=7, tests= 5000) {
	runs<-getRunsMatrix(n, runLength);
	passed= 0;
	for(i in 1:tests) {
		flips<-getFlipsMatrix(n);
		if(testForRuns(flips, runs, runLength)){
			passed= passed+1;
		}
	}
	return(passed/tests);
}

print(getProbability());
